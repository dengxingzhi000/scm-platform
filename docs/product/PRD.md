# 产品需求规格说明书 (PRD)
# SCM Platform - Supply Chain Management System

> **文档类型**: 产品需求规格说明书 (Product Requirements Document)
> **产品负责人**: 产品总监
> **目标用户**: 供应链管理人员、仓储管理员、采购人员、物流调度员
> **版本**: v1.0
> **最后更新**: 2025-12-24

---

## 一、产品概述

### 1.1 产品定位

SCM Platform 是一款**企业级供应链管理系统**，面向中大型电商、零售、制造企业，提供从**采购→入库→库存→订单→出库→物流**的全链路数字化管理能力。

**对标产品**:
- **阿里巴巴**: 菜鸟供应链、1688采购平台
- **京东**: 京东物流 WMS、JD Supply Chain
- **美团**: 美团配送、快驴进货
- **Shopify**: Fulfillment Network

### 1.2 核心价值

| 用户角色 | 核心痛点 | 解决方案 | 价值 |
|---------|---------|---------|------|
| **采购人员** | 手工管理供应商，补货不及时 | 智能补货算法 + 供应商协同 | 库存周转率提升 30% |
| **仓管人员** | 库存数据不准确，盘点效率低 | 实时库存同步 + RFID盘点 | 盘点效率提升 50% |
| **运营人员** | 订单处理慢，履约时效差 | 自动化订单流转 + 智能分仓 | 订单处理时长减少 40% |
| **财务人员** | 对账繁琐，结算周期长 | 自动对账 + 电子发票 | 对账时间缩短 60% |
| **管理层** | 数据分散，决策缺乏依据 | 实时数据大屏 + BI报表 | 决策效率提升 80% |

### 1.3 产品目标

#### 业务目标 (OKR)

**O1: 提升供应链运营效率**
- KR1: 订单处理时长 < 30秒（当前 2分钟）
- KR2: 库存准确率 > 99.5%（当前 95%）
- KR3: 仓储作业效率提升 50%

**O2: 降低供应链成本**
- KR1: 库存周转天数降低 20%
- KR2: 缺货率 < 1%（当前 5%）
- KR3: 物流成本降低 15%

**O3: 提升用户体验**
- KR1: 订单履约时效 < 24小时（当前 48小时）
- KR2: 订单准确率 > 99.9%
- KR3: 用户满意度 > 4.8/5.0

#### 技术目标

- **性能**: API 响应 P99 < 100ms，订单 TPS > 10,000
- **可用性**: 系统可用性 > 99.9%（年停机时间 < 8.76小时）
- **扩展性**: 支持 10万+ SKU，1000万+ 日订单量

---

## 二、用户画像与场景

### 2.1 用户角色

#### 角色1: 采购经理（张经理，35岁）

**背景**:
- 负责公司 5000+ SKU 的采购管理
- 管理 50+ 供应商
- 每月采购金额 500万元

**典型一天**:
- 09:00 - 查看安全库存预警，发现 30 个 SKU 需要补货
- 10:00 - 手动计算补货数量，向 3 个供应商发送采购单（Excel）
- 14:00 - 跟供应商电话确认交期
- 16:00 - 在 ERP 系统手工录入采购单

**痛点**:
- ❌ 补货依赖人工判断，经常缺货或积压
- ❌ 采购单手工录入，效率低易出错
- ❌ 供应商交期不透明，无法追踪

**期望**:
- ✅ 系统自动预警缺货，推荐补货数量
- ✅ 一键生成采购单并发送给供应商
- ✅ 实时追踪采购单状态

#### 角色2: 仓库管理员（李主管，28岁）

**背景**:
- 管理 2 个仓库（华东仓、华南仓）
- 每天处理 500+ 入库单、800+ 出库单
- 库存 SKU 8000+

**典型一天**:
- 08:00 - 打印今日拣货单（200张）
- 09:00 - 安排 10 名拣货员按单拣货
- 11:00 - 手工核对库存，发现账实不符
- 14:00 - 处理异常订单（缺货、串货）
- 17:00 - 盘点高价值商品

**痛点**:
- ❌ 拣货路径不优化，拣货员走重复路
- ❌ 库存数据延迟，账实不符率 5%
- ❌ 盘点全靠人工，效率低易出错

**期望**:
- ✅ 系统自动规划最优拣货路径
- ✅ 实时同步库存，扫码即更新
- ✅ RFID 自动盘点，15分钟完成全仓

#### 角色3: 运营人员（王运营，26岁）

**背景**:
- 负责电商平台订单履约
- 每天处理 5000+ 订单
- 对接 3 个仓库、5 家物流公司

**典型一天**:
- 09:00 - 处理昨晚积压的 200 个订单
- 10:00 - 手动分配订单到仓库（北京订单→华北仓）
- 14:00 - 处理缺货订单，联系调货
- 16:00 - 导出物流单号，批量导入快递系统
- 18:00 - 处理客服转来的异常订单

**痛点**:
- ❌ 订单分配靠人工判断，效率低
- ❌ 缺货处理流程长，影响时效
- ❌ 物流系统割裂，需要多系统操作

**期望**:
- ✅ 订单自动路由到最近仓库
- ✅ 缺货自动调货或拆单
- ✅ 一键推送物流单到快递公司

### 2.2 核心业务场景

#### 场景1: 秒杀抢购（高并发场景）

**背景**: 双11活动，某爆款商品 10秒内 10万人抢购 1000件

**业务流程**:
```
用户下单 → 库存扣减 → 生成订单 → 支付 → 锁定库存 → 仓库出库
```

**系统要求**:
- **并发**: 峰值 10万 QPS
- **一致性**: 库存不超卖、不少卖
- **性能**: 下单响应 < 200ms
- **容错**: 部分服务降级不影响主流程

**技术方案**:
- Redis Lua 脚本原子扣减库存
- Seata 分布式事务保证订单-库存一致性
- Sentinel 限流降级
- RabbitMQ 削峰填谷

#### 场景2: 智能补货（算法驱动）

**背景**: 某 SKU 库存降至安全库存以下，系统自动触发补货

**业务流程**:
```
库存监控 → 销量预测 → 计算补货量 → 选择供应商 → 生成采购单 → 发送供应商
```

**系统要求**:
- **准确性**: 预测误差 < 10%
- **时效性**: 实时监控，5分钟内触发
- **智能化**: 考虑销量趋势、季节性、促销活动

**技术方案**:
- XXL-Job 定时扫描库存水位
- LSTM 神经网络预测销量
- 贪心算法选择最优供应商（价格、交期、质量）

#### 场景3: 全链路追踪（可观测性）

**背景**: 用户投诉"订单已发货3天还未收到"，客服需要快速定位

**业务流程**:
```
订单号 → 查询订单状态 → 查看物流轨迹 → 联系配送员 → 反馈用户
```

**系统要求**:
- **可追溯**: 订单全生命周期可查
- **实时性**: 物流轨迹延迟 < 5分钟
- **可视化**: 地图展示配送位置

**技术方案**:
- SkyWalking 分布式链路追踪
- 物流公司 Webhook 回调推送轨迹
- 高德地图 API 轨迹展示

---

## 三、功能需求

### 3.1 功能模块地图

```
SCM Platform
├── 商品管理
│   ├── SPU/SKU管理
│   ├── 类目管理
│   ├── 品牌管理
│   ├── 商品搜索（ES）
│   └── 商品图片管理
│
├── 库存管理（核心）
│   ├── 实时库存查询
│   ├── 库存扣减（Redis Lua）
│   ├── 预占库存
│   ├── 库存调拨
│   ├── 安全库存预警
│   └── 库存盘点
│
├── 订单管理
│   ├── 订单创建
│   ├── 订单状态机
│   ├── 订单支付（Seata）
│   ├── 订单履约
│   ├── 订单取消/退货
│   └── 订单搜索
│
├── 仓储管理（WMS）
│   ├── 入库管理
│   ├── 出库管理
│   ├── 上架/下架
│   ├── 拣货路径优化
│   ├── 盘点管理
│   └── 库位管理
│
├── 物流管理（TMS）
│   ├── 运单管理
│   ├── 配送调度
│   ├── 轨迹追踪
│   ├── 电子面单
│   └── 签收确认
│
├── 采购管理
│   ├── 采购计划
│   ├── 采购单管理
│   ├── 供应商管理
│   ├── 供应商协同
│   └── 采购对账
│
├── 结算管理
│   ├── 供应商结算
│   ├── 物流结算
│   ├── 对账管理
│   └── 发票管理
│
└── 报表分析
    ├── 实时大屏
    ├── 销售报表
    ├── 库存报表
    ├── 采购报表
    └── 财务报表
```

### 3.2 核心功能详细说明

#### 功能1: 库存扣减（P0 核心）

**用户故事**:
> 作为**运营人员**，当用户下单时，我希望**系统自动扣减库存**，以便**避免超卖**。

**功能描述**:
- 用户下单后，系统实时扣减对应 SKU 的可用库存
- 扣减失败（库存不足）则提示用户"库存不足"
- 支持并发扣减，保证原子性
- 支持预占库存（下单扣减，15分钟未支付自动释放）

**验收标准**:
- [ ] 并发 1000 用户同时购买同一 SKU，库存扣减准确（不超卖、不少卖）
- [ ] 扣减响应时间 P99 < 50ms
- [ ] 支持 Redis Lua 脚本扣减
- [ ] 支持预占库存 + 定时释放

**优先级**: P0（必须有）
**实现难度**: ⭐⭐⭐⭐⭐
**工作量**: 5人日

#### 功能2: 订单状态机（P0 核心）

**用户故事**:
> 作为**运营人员**，我希望**订单状态自动流转**，以便**减少人工干预**。

**功能描述**:
- 订单状态: 待支付 → 已支付 → 待发货 → 已发货 → 运输中 → 已送达 → 已完成
- 支持状态事件触发: 支付成功、仓库分配、发货、物流更新、签收
- 异常状态: 支付超时自动取消、发货超时预警
- 状态流转记录可追溯

**状态转移图**:
```
           支付成功
PENDING_PAYMENT ────→ PAID ────→ PENDING_SHIP
      │                              │
      │ 超时15分钟                    │ 仓库分配
      ↓                              ↓
  CANCELLED                       SHIPPED
                                     │
                                     │ 物流揽收
                                     ↓
                                 IN_TRANSIT
                                     │
                                     │ 签收
                                     ↓
                                 DELIVERED
                                     │
                                     │ 确认收货/自动确认
                                     ↓
                                 COMPLETED
```

**验收标准**:
- [ ] 支持 Spring State Machine 实现
- [ ] 支持事件驱动状态流转
- [ ] 支持超时自动取消（XXL-Job）
- [ ] 状态流转记录可查询

**优先级**: P0（必须有）
**实现难度**: ⭐⭐⭐⭐
**工作量**: 8人日

#### 功能3: 商品搜索（P0 核心）

**用户故事**:
> 作为**用户**，我希望**快速搜索商品**，以便**找到想要的商品**。

**功能描述**:
- 支持关键词搜索（商品名称、描述）
- 支持类目筛选
- 支持价格区间筛选
- 支持排序（综合、价格、销量）
- 支持中文分词（IK Analyzer）
- 支持拼音搜索
- 搜索结果高亮

**搜索示例**:
```
关键词: "苹果手机"
筛选: 类目=手机, 价格=5000-8000
排序: 销量降序
结果: iPhone 15 Pro, iPhone 15, iPhone 14 Pro...
```

**验收标准**:
- [ ] Elasticsearch 8.11+ 实现
- [ ] IK 中文分词
- [ ] 搜索响应 P99 < 100ms
- [ ] 支持 QPS > 50,000
- [ ] Canal 实时同步 MySQL → ES

**优先级**: P0（必须有）
**实现难度**: ⭐⭐⭐⭐
**工作量**: 6人日

#### 功能4: 拣货路径优化（P1 重要）

**用户故事**:
> 作为**仓管员**，我希望**系统规划最优拣货路径**，以便**提高拣货效率**。

**功能描述**:
- 根据订单商品的库位，计算最短拣货路径
- 支持波次拣货（将多个订单合并为一个拣货任务）
- 支持分区拣货（按仓库分区并行拣货）
- 路径可视化展示

**算法**:
- TSP（旅行商问题）求解
- 贪心算法 / 遗传算法
- 考虑库位距离、商品体积、拣货员负载

**验收标准**:
- [ ] 拣货路径长度减少 30%
- [ ] 支持波次拣货（1次拣货完成10个订单）
- [ ] 路径计算时间 < 1秒

**优先级**: P1（重要）
**实现难度**: ⭐⭐⭐⭐⭐
**工作量**: 10人日

#### 功能5: 智能补货（P1 重要）

**用户故事**:
> 作为**采购经理**，我希望**系统自动推荐补货数量**，以便**减少缺货和积压**。

**功能描述**:
- 实时监控库存水位，低于安全库存自动预警
- 基于历史销量、季节性、促销活动预测未来销量
- 推荐补货数量 = 预测销量 - 当前库存 - 在途库存
- 自动生成采购单

**预测模型**:
- 时间序列预测（ARIMA / LSTM）
- 考虑因素: 历史销量、节假日、促销活动、季节性

**验收标准**:
- [ ] 预测准确率 > 90%
- [ ] 缺货率降低 50%
- [ ] 库存周转天数降低 20%

**优先级**: P1（重要）
**实现难度**: ⭐⭐⭐⭐⭐
**工作量**: 15人日

### 3.3 功能优先级矩阵

| 功能 | 业务价值 | 用户需求度 | 实现难度 | 优先级 | 迭代 |
|-----|---------|-----------|---------|--------|------|
| 库存扣减 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | P0 | MVP |
| 订单状态机 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | P0 | MVP |
| 商品搜索 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | P0 | MVP |
| 仓储出入库 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | P0 | MVP |
| 拣货路径优化 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | P1 | V1.1 |
| 智能补货 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | P1 | V1.2 |
| 物流追踪 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | P1 | V1.1 |
| 供应商协同 | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | P2 | V1.3 |
| BI报表 | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | P2 | V1.3 |

---

## 四、非功能需求

### 4.1 性能需求

| 指标 | 目标值 | 当前值 | 测试方法 |
|-----|--------|--------|---------|
| **API响应时间（P99）** | < 100ms | - | JMeter压测 |
| **订单创建 TPS** | > 10,000 | - | JMeter + Seata |
| **库存扣减 TPS** | > 20,000 | - | Redis Lua压测 |
| **商品搜索 QPS** | > 50,000 | - | ES压测 |
| **并发用户数** | > 10,000 | - | 秒杀场景压测 |
| **数据库连接数** | < 500 | - | Druid监控 |

### 4.2 可用性需求

- **系统可用性**: 99.9%（年停机时间 < 8.76小时）
- **故障恢复时间（RTO）**: < 30分钟
- **数据恢复点（RPO）**: < 5分钟
- **服务降级**: 非核心服务降级，核心流程（下单、支付）不受影响

### 4.3 安全需求

- **认证**: JWT + OAuth2
- **授权**: RBAC + 数据权限
- **数据加密**: AES-256（敏感字段）
- **审计日志**: 所有敏感操作记录
- **防护**: SQL注入、XSS、CSRF防护

### 4.4 扩展性需求

- **数据量**: 支持 10万+ SKU，1亿+ 订单
- **并发**: 支持 10万+ 并发用户
- **水平扩展**: 服务无状态，支持水平扩展
- **分库分表**: ShardingSphere 自动分表

### 4.5 兼容性需求

- **浏览器**: Chrome 90+, Firefox 80+, Safari 14+
- **操作系统**: Windows 10+, macOS 11+, Ubuntu 20.04+
- **数据库**: PostgreSQL 14+, MySQL 8.0+
- **中间件**: Redis 7.0+, Elasticsearch 8.11+, Kafka 3.0+

---

## 五、产品路线图

### MVP（最小可行产品）- 6周

**目标**: 完成核心功能，验证业务闭环

**功能清单**:
- ✅ 商品管理（SPU/SKU）
- ✅ 库存管理（扣减、预占）
- ✅ 订单管理（状态机）
- ✅ 商品搜索（ES）
- ✅ 仓储出入库

**交付标准**:
- 核心流程打通: 下单 → 扣库存 → 出库 → 发货
- 性能达标: 订单 TPS > 5000
- 压测报告完成

### V1.1（增强版）- 4周

**目标**: 提升运营效率

**功能清单**:
- ✅ 拣货路径优化
- ✅ 物流追踪
- ✅ 订单超时取消（XXL-Job）
- ✅ 库存预警

**交付标准**:
- 拣货效率提升 30%
- 订单履约时长 < 24小时

### V1.2（智能化）- 4周

**目标**: 引入算法驱动

**功能清单**:
- ✅ 智能补货（LSTM）
- ✅ 智能分仓（就近分配）
- ✅ 异常订单检测（AI）

**交付标准**:
- 补货预测准确率 > 90%
- 缺货率 < 1%

### V1.3（生态对接）- 4周

**目标**: 打通供应链上下游

**功能清单**:
- ✅ 供应商协同（EDI）
- ✅ 物流公司对接（菜鸟、顺丰）
- ✅ BI报表中心
- ✅ 开放API平台

**交付标准**:
- 供应商在线率 > 80%
- 物流轨迹覆盖率 > 95%

---

## 六、成功指标

### 6.1 北极星指标

**订单履约时长（下单到签收）**
- 当前: 48小时
- 目标: 24小时
- 提升: 50%

### 6.2 关键指标

| 指标 | 当前值 | 目标值 | 提升 |
|-----|--------|--------|------|
| 订单处理时长 | 2分钟 | 30秒 | 75% ↓ |
| 库存准确率 | 95% | 99.5% | 4.5% ↑ |
| 缺货率 | 5% | 1% | 80% ↓ |
| 库存周转天数 | 45天 | 36天 | 20% ↓ |
| 用户满意度 | 4.2/5.0 | 4.8/5.0 | 14% ↑ |

### 6.3 业务指标

**运营效率**:
- 仓储作业效率提升 50%
- 拣货准确率 > 99.9%
- 盘点效率提升 60%

**成本降低**:
- 库存成本降低 15%
- 物流成本降低 10%
- 人工成本降低 20%

**用户体验**:
- 订单准确率 > 99.9%
- 物流轨迹可查率 > 95%
- 客诉率 < 0.5%

---

## 七、风险与依赖

### 7.1 业务风险

| 风险 | 概率 | 影响 | 缓解措施 |
|-----|------|------|---------|
| 供应商不配合接入 | 高 | 高 | 提供API文档 + 技术支持 |
| 用户习惯改变困难 | 中 | 中 | 培训 + 操作手册 |
| 数据迁移失败 | 中 | 高 | 灰度迁移 + 双写验证 |

### 7.2 技术风险

| 风险 | 概率 | 影响 | 缓解措施 |
|-----|------|------|---------|
| Seata 性能瓶颈 | 中 | 高 | 集群部署 + TCC模式 |
| ES 数据同步延迟 | 中 | 中 | Canal优化 + 降级方案 |
| Redis 雪崩 | 低 | 高 | 缓存预热 + 降级 |

### 7.3 外部依赖

- **物流公司 API**: 顺丰、菜鸟、京东物流
- **支付接口**: 微信支付、支付宝
- **地图服务**: 高德地图
- **短信服务**: 阿里云短信

---

## 八、附录

### 8.1 术语表

| 术语 | 英文 | 解释 |
|-----|------|------|
| SPU | Standard Product Unit | 标准产品单位（如"iPhone 15"） |
| SKU | Stock Keeping Unit | 库存单位（如"iPhone 15 256G 黑色"） |
| WMS | Warehouse Management System | 仓储管理系统 |
| TMS | Transportation Management System | 运输管理系统 |
| OMS | Order Management System | 订单管理系统 |
| EDI | Electronic Data Interchange | 电子数据交换 |

### 8.2 参考资料

- [阿里菜鸟供应链白皮书](https://www.cainiao.com/whitepaper)
- [京东物流技术揭秘](https://jdl.jd.com/tech)
- [美团配送系统架构](https://tech.meituan.com)
- [Shopify Fulfillment Network](https://www.shopify.com/fulfillment)

---

**文档维护**: 产品团队
**审批**: 产品总监 + CEO
**版本**: v1.0
**最后更新**: 2025-12-24
